Some experiments with a new rewrite
Both trying different ways and also trying to make it smaller
